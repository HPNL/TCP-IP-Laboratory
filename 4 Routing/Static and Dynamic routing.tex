\documentclass[10pt,a4paper]{article}
\usepackage{arabtex}
\usepackage[OT1,T1,LFE,LAE]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[arabic,english,farsi]{babel}
\usepackage{amsmath,amsfonts} % Math packages
\usepackage{amssymb}

\usepackage{multicol}

\usepackage{graphicx}
\usepackage{color}
\usepackage{float}
\usepackage{sidecap}
\usepackage{anysize}
\marginsize{2cm}{2cm}{2cm}{2cm}

\usepackage{listings}

\usepackage{appendix}

\usepackage[colorlinks=true,plainpages=true,citecolor=blue,linkcolor=blue,urlcolor=cyan]{hyperref}

%%% Equation and float numbering
\numberwithin{equation}{section}
\numberwithin{figure}{section}
\numberwithin{table}{section}


\newcommand{\horrule}[1]{\rule{\linewidth}{#1}} 	% Horizontal rule

\newcommand{\titleText}{Static and Dynamic routing \\ Laboratory Manual}

\title{
\normalsize In the name of Allah\\
\vspace{10pt}
\LARGE\FR{بسم \allah الرحمن الرحیم}
\vspace{10pt}
\begin{center}
	%	\newcommand{\HRule}{\rule{\linewidth}{0.5mm}}
	\begin{minipage}{0.48\textwidth} \begin{flushleft}
			\includegraphics[height=64pt,width=64pt]{../img/logo.png}
	\end{flushleft}\end{minipage}
	\begin{minipage}{0.48\textwidth} \begin{flushright}
			\includegraphics[height=64pt]{../img/eng-logo.png}
	\end{flushright}\end{minipage}
\end{center}
\vspace*{-64pt}
%	\horrule{0.5pt} \\[0.4cm]
	\huge \titleText\\
\vspace{40pt}
%	\horrule{2pt} \\[0.5cm]
}
\author{
	\huge University of Tehran\\
	\LARGE \FR{دانشگاه تهران}\\
	\\
	\LARGE School of Electrical and Computer Engineering\\
	\FR{دانشکده مهندسی برق و کامپیوتر}\\
	\\
	\Large Computer Network Lab\\
	\FR{آزمایشگاه شبکه‌های کامپیوتری}\\
	\\
	\\
	\\
	\normalfont
	Dr. Ahmad Khonsari - \FR{احمد خونساری}\\
	\href{mailto:a_khonsari@ut.ac.ir}{a\_khonsari@ut.ac.ir}\\
	\\
	\normalsize
	Amir Haji Ali Khamseh'i - \FR{امیر حاجی علی خمسه‌ء}\\
	\href{mailto:khamse@ut.ac.ir}{khamse@ut.ac.ir}\\
	\\
	\normalsize
	Sina Kashi pazha - \FR{سینا کاشی پزها}\\
	\href{mailto:sina\_kashipazha@ut.ac.ir}{sina\_kashipazha@ut.ac.ir}\\
	\\
	\normalsize
	Amirahmad Khordadi - \FR{امیر احمد خردادی}\\
	\href{mailto:a.a.khordadi@ut.ac.ir}{a.a.khordadi@ut.ac.ir}
}

\date{\vspace{30pt}\today\\\vspace{10pt}{\selectlanguage{farsi}\today}}

\usepackage{fancyhdr} 
\pagestyle{fancy}
%\pagestyle{fancyplain}
\fancyhf{}
\fancyhead[L]{\footnotesize Computer Network Lab \\ \FR{آزمایشگاه شبکه‌های کامپیوتری}}
\fancyhead[R]{\footnotesize \titleText}
\fancyfoot[R]{\footnotesize School of Electrical and Computer Engineering\\\FR{دانشکده مهندسی برق و کامپیوتر}}
\fancyfoot[C]{\thepage}
\fancyfoot[L]{\footnotesize University of Tehran \\ \FR{دانشگاه تهران}}
\renewcommand{\footrulewidth}{0.8pt}
\renewcommand{\headrulewidth}{1pt}			% Remove header underlines
\renewcommand{\footrulewidth}{1pt}				% Remove footer underlines
\setlength{\headheight}{13.6pt}
 

\begin{document}
\selectlanguage{english}

%\vspace*{-1.5cm}
\maketitle


\pagebreak


\section{Introduction}
In this session, we try checking switch network loop in Mininet and after implement it on Cisco devices. At the end of this session you must able to config Cisco switch and router.

\subsection*{Requirement}
\begin{itemize}
    \item Mininet + bridge-utils
    \item Cisco Packet Tracer or physical switch \& router
\end{itemize}

\section{A Simple Router Experiment}
    In this experiment we need custom topology like Figure \ref{fig:topology}. Official Mininet branch doesn't have any kind of router. To add touter in your topology we are using simple trick which means adding another host and confige that to act like router. Check out router.py example in home directory of your machine and complete it to reflect \ref{fig:topology}.

    \begin{itemize}
        \setlength{\itemindent}{10pt}
        \item [\$]  \textbf{sudo python router.py}
        \item [\$] run \textbf{wireshark \&} on mininet's hosts and ubuntu machine to capture packets
    \end{itemize}
    
\begin{figure}[H]
    \centering
    \includegraphics[height=155pt]{img/fig1.png}
    \caption{Mininet Topology}
    \label{fig:topology}
\end{figure}

    \subsubsection*{ Lab Report}
    \begin{itemize}
    	\setlength{\itemindent}{0pt}
    	\item When a packet was sent to a workstation in the other subnet, explain how the source and destination Ethernet addresses were changed.
    	\item What are the source and destination addresses in the IP and Ethernet headers of a packet that went from your machine to the router?
    	\item What are the source and destination addresses in the IP and Ethernet headers of a packet that went from the router to your partner’s machine?
    	\item Answer the above two questions, but now for the echo reply that was returned from your partner’s machine.
    \end{itemize}

\subsubsection*{ Lab Report}
\begin{itemize}
	\setlength{\itemindent}{0pt}
	\item Use the Wireshark outputs from both machines to calculate the average delay that a packet experienced in the router. Note that the system times of the two machines might be different. Show all the steps and submit the Wireshark outputs with your report.
	\item [\(Optional\)] \indent  Compare this value with the previous value in the case of the bridge. Which, a router or a bridge, is faster? Why?
\end{itemize}

\section{Static routing}
  Use what you had learned from previous experiment and config \ref{fig:linearRouters} topology in mininet. Use 255.255.255.0 subnet for all interfaces. \\
  Use ping to test the connections. When you can reach all other subnets successfully, save the routing tables in your workstation and all the routers for the lab report.

\begin{figure}[H]
	\centering
	\includegraphics[height=30pt]{img/fig2.png}
	\caption{Mininet Topology}
	\label{fig:linearRouters}
\end{figure}

  \subsubsection*{ Lab Report}
\begin{itemize}
	\setlength{\itemindent}{0pt}
	\item Submit the routing tables of hosts and routers.
\end{itemize}

\section{Traceroute experiment}
In this exercise, we use the same network and configuration of the previous exercises, and use traceroute to find a multi-hop path.
Execute Wireshark on h1 and h2. Then, execute traceroute 10.0.3.10 on h1 to find the route from your host to the h2. Save the output of both traceroute and wireshark.

\subsubsection*{ Lab Report}
\begin{itemize}
	\setlength{\itemindent}{0pt}
	\item Submit what you saved in this exercise.
	\item From the tcpdump output, explain how the multi-hop route was found. Explain the sequence of the ICMP messages used.
\end{itemize}


\section{RIP exercises}
    In this section, we will examine the operation of RIP. To enable the RIP routing process in a router, use the following commands in the Global Configuration mode.\\
    \begin{itemize}
    	\setlength{\itemindent}{60pt}
    	\item [Router(config) \#] \textbf{router riprouter rip}
    	\item [Router(config) \#]  network network number
    \end{itemize}
     where network number could be 128.238.0.0. To remove the network, use:
     \begin{itemize}
     	\setlength{\itemindent}{60pt}
     	\item [Router(config) \#] no network network number
     \end{itemize}
 
 To shutdown the RIP process, use:
 \begin{itemize}
	\setlength{\itemindent}{60pt}
	\item [Router(config) \#] no router rip
\end{itemize}

Consider \ref{fig:topo} as our network topology for this section. Since the IP
address of ethernet1 in router4 is the only interface which is different from the initial configuration in Appendix B, we will reboot all the four routers to restore their default configurations, and change the IP address on the ethernet1 in router4 only. Since our workstations started routed at boot-up time, no further action is needed to run RIP on the workstations.
Connect the routers and hosts and change the IP addresses of the workstations and router4 as shown in Fig. 4.11. Also, make sure that your workstation has no other routing entries than your own subnet and your loopback interface. For how to remove an entry from the host routing table, see Section 4.3.
Run the RIP process in each router. To avoid confusion, each router should be configured by only one person.
After starting RIP in all the routers, test connections to other hosts by pinging them. Once you can successfully reach all the hosts, run the following command to capture the RIP messages sent on your subnet:
tcpdump -x -s 100 -c 4 -w exe2.out udp port 520.
Save the routing table in your workstation. Note the number of hops needed to reach
destinations other than in your own subnet.
Run ethereal -r exe2.out \& to load the packet trace recorded by the above tcpdump command. Mark and print two different RIP messages captured in your subnet (see Exercise 6 of Chapter 1). Exchange the printed RIP messages with students in other groups. You need eight different RIP messages for your lab report.

\subsubsection*{Lab Report}
\begin{itemize}
	\setlength{\itemindent}{0pt}
	\item Explain why you can only get two different RIP messages in your subnet. Was a RIP packet forwarded by the routers? Why?
	\item Draw the format of one of the saved RIP response packets from your sub- net, including the IP and UDP headers and the RIP message (see Figs 0.13, 0.14, and 4.4). Identify each field, and express their values in decimal format. \\
	For the other seven RIP response packets collected, explain the contents of
the RIP messages only, excluding IP and UDP headers.
	\item Draw the distance tables and the routing tables in the routers based on Fig. 4.11, assuming that number of hops is used as the metric. Verify the routing tables using the RIP messages you captured.
\end{itemize}

\subsubsection*{ Lab Report}
\begin{itemize}
	\setlength{\itemindent}{0pt}
	\item Compare this time with the previous value in the spanning tree experiment. Explain why it takes this time for RIP to react to the route change. Refer to Section 4.2.4 for RIP operation and default timer values.
\end{itemize}

\begin{figure}[H]
	\centering
    \includegraphics[height=300pt]{img/fig4.png}
    \caption{Implemented Topology in CPT}
    \label{fig:Topo}
\end{figure}



\end{document}